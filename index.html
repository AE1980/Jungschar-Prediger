<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Person der Woche</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    .person {
      font-size: 1.5em;
      margin: 10px;
      color: #0077cc;
    }
    .alt {
      font-size: 0.9em;
      color: #666;
      margin-top: 30px;
    }
    h1 {
      text-decoration: underline;
      text-decoration-color: #FF0000;
      text-underline-offset: 4px;
      color: #FF0000;
    }
  </style>
</head>
<body>
  <h1>Jeden Mittwoch werden neue Personen generiert</h1>
  <h2 id="ueberschrift">Person f체r n채chste Stunde</h2>
  <div class="person" id="hauptperson">Lade...</div>
  <h2 id="ersatzueberschrift">Ersatzpersonen:</h2>
  <div class="person" id="ersatz1">Lade...</div>
  <div class="person" id="ersatz2">Lade...</div>

  <div class="alt">
    <p><strong>Letzten Mittwoch generierte Personen<br>
    (Person, welche diesen Mittwoch dran ist):</strong></p>
    <p id="alt1">...</p>
    <p id="alt2">...</p>
    <p id="alt3">...</p>
  </div>

  <script>
    const personen = [
      "Levi K.",
      "Johnatan S.",
      "Elia",
      "Samuel H.",
      "Lukas E.",
      "Philias",
      "Silas E.",
      "Juri",
      "Simon P.",
      "Johannes H.",
      "Noel A."
    ];

    function getCustomWeek(date) {
      const adjusted = new Date(date);
      const day = adjusted.getDay();
      const offset = (day < 3) ? -7 : 0;
      adjusted.setDate(adjusted.getDate() + offset);
      const firstJan = new Date(adjusted.getFullYear(), 0, 1);
      const days = Math.floor((adjusted - firstJan) / 86400000);
      return Math.ceil((days + firstJan.getDay() + 1) / 7);
    }

    function getNextWednesday(date) {
      const day = date.getDay();
      const diff = (3 - day + 7) % 7 || 7;
      const nextWednesday = new Date(date);
      nextWednesday.setDate(date.getDate() + diff);
      return nextWednesday.toLocaleDateString("de-DE", {
        weekday: "long",
        day: "2-digit",
        month: "2-digit",
        year: "numeric"
      });
    }

    function getLastOrTodayWednesday(date) {
      const day = date.getDay();
      const lastWednesday = new Date(date);
      if (day === 3) {
        // heute ist Mittwoch
        return lastWednesday.toLocaleDateString("de-DE", {
          weekday: "long",
          day: "2-digit",
          month: "2-digit",
          year: "numeric"
        });
      } else {
        const diff = (day + 4) % 7 || 7;
        lastWednesday.setDate(date.getDate() - diff);
        return lastWednesday.toLocaleDateString("de-DE", {
          weekday: "long",
          day: "2-digit",
          month: "2-digit",
          year: "numeric"
        });
      }
    }

    function seededShuffle(array, seed) {
      let result = array.slice();
      let rng = mulberry32(seed);
      for (let i = result.length - 1; i > 0; i--) {
        const j = Math.floor(rng() * (i + 1));
        [result[i], result[j]] = [result[j], result[i]];
      }
      return result;
    }

    function mulberry32(a) {
      return function() {
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ t >>> 15, t | 1);
        t ^= t + Math.imul(t ^ t >>> 7, t | 61);
        return ((t ^ t >>> 14) >>> 0) / 4294967296;
      };
    }

    const heute = new Date();
    const jahr = heute.getFullYear();
    const woche = getCustomWeek(heute);
    const seedAktuell = jahr * 100 + woche;
    const seedVorwoche = jahr * 100 + (woche - 1);

    const aktuell = seededShuffle(personen, seedAktuell);
    const vorher = seededShuffle(personen, seedVorwoche);

    document.getElementById("hauptperson").textContent = aktuell[0];
    document.getElementById("ersatz1").textContent = aktuell[1];
    document.getElementById("ersatz2").textContent = aktuell[2];

    document.getElementById("alt1").textContent = vorher[0];
    document.getElementById("alt2").textContent = vorher[1];
    document.getElementById("alt3").textContent = vorher[2];

    const mittwochDatum = getNextWednesday(heute);
    document.getElementById("ueberschrift").textContent =
      `Person f체r n채chste Stunde (${mittwochDatum})`;

    const letzterMittwoch = getLastOrTodayWednesday(heute);
    document.getElementById("ersatzueberschrift").textContent =
      `Ersatzpersonen (${letzterMittwoch})`;
  </script>
</body>
</html>
